\hypertarget{a00338}{}\section{dma.\+h File Reference}
\label{a00338}\index{dma.\+h@{dma.\+h}}


Wrapper functions for direct memory access hardware.  


{\ttfamily \#include $<$snes/snestypes.\+h$>$}\newline
{\ttfamily \#include $<$snes/background.\+h$>$}\newline
{\ttfamily \#include $<$snes/sprite.\+h$>$}\newline
{\ttfamily \#include $<$snes/video.\+h$>$}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{a00338_af57b905f605a7fe58fc009025fb3d30b}\label{a00338_af57b905f605a7fe58fc009025fb3d30b}} 
\#define \hyperlink{a00338_af57b905f605a7fe58fc009025fb3d30b}{D\+M\+A\+\_\+\+E\+N\+A\+B\+LE}~1
\begin{DoxyCompactList}\small\item\em Bit defines for the D\+MA control registers. \end{DoxyCompactList}\item 
\#define \hyperlink{a00338_a384405596b1aadf2454e966455d74228}{R\+E\+G\+\_\+\+A1\+B7}~($\ast$(vuint8$\ast$)0x4374)
\begin{DoxyCompactList}\small\item\em A1\+TxL -\/ H\+D\+MA Table Start Address (low) / D\+MA Current Addr (low) (R/W) A1\+TxH -\/ H\+D\+MA Table Start Address (hi) / D\+MA Current Addr (hi) (R/W) A1\+Bx -\/ H\+D\+MA Table Start Address (bank) / D\+MA Current Addr (bank) (R/W) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{a00338_a2acebf455ea5a03345af0a3af2340a97}\label{a00338_a2acebf455ea5a03345af0a3af2340a97}} 
\#define \hyperlink{a00338_a2acebf455ea5a03345af0a3af2340a97}{R\+E\+G\+\_\+\+B\+B\+A\+D7}~($\ast$(vuint8$\ast$)0x4371)
\begin{DoxyCompactList}\small\item\em D\+M\+A/\+H\+D\+MA I/\+O-\/\+Bus Address (P\+P\+U-\/\+Bus aka B-\/\+Bus) (R/W) For both D\+MA and H\+D\+MA\+: 7-\/0 B-\/\+Bus Address (selects an I/O Port which is mapped to 2100h-\/21\+F\+Fh) \end{DoxyCompactList}\item 
\#define \hyperlink{a00338_ac9dca819788af60976b8d4956f76ead6}{R\+E\+G\+\_\+\+D\+A\+S7\+LH}~($\ast$(vuint16$\ast$)0x4375)
\begin{DoxyCompactList}\small\item\em Indirect H\+D\+MA Address (low) / D\+MA Byte-\/\+Counter (low) (R/W) D\+A\+SxL -\/ Indirect H\+D\+MA Address (low) / D\+MA Byte-\/\+Counter (low) (R/W) D\+A\+SxH -\/ Indirect H\+D\+MA Address (hi) / D\+MA Byte-\/\+Counter (hi) (R/W) 43x7h -\/ D\+A\+S\+Bx -\/ Indirect H\+D\+MA Address (bank) (R/W) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{a00338_a468ac9497087f0cbab21a3e0453f438b}\label{a00338_a468ac9497087f0cbab21a3e0453f438b}} 
\#define \hyperlink{a00338_a468ac9497087f0cbab21a3e0453f438b}{R\+E\+G\+\_\+\+H\+D\+M\+A\+EN}~($\ast$(vuint8$\ast$)0x420\+C)
\begin{DoxyCompactList}\small\item\em Select H-\/\+Blank D\+MA (H-\/\+D\+MA) Channel(s) (W) 7-\/0 H-\/\+D\+MA Channel 7-\/0 Enable (0=Disable, 1=Enable) \end{DoxyCompactList}\item 
\#define \hyperlink{a00338_abccd357db38cf6e7528e807b8692ef0f}{R\+E\+G\+\_\+\+M\+D\+M\+A\+EN}~($\ast$(vuint8$\ast$)0x420\+B)
\begin{DoxyCompactList}\small\item\em Select General Purpose D\+MA Channel(s) and Start Transfer (W) 7-\/0 General Purpose D\+MA Channel 7-\/0 Enable (0=Disable, 1=Enable) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{a00338_ae4e12cfcb45d2b308eb558fcfe309737}\label{a00338_ae4e12cfcb45d2b308eb558fcfe309737}} 
void \hyperlink{a00338_ae4e12cfcb45d2b308eb558fcfe309737}{dma\+Clear\+Vram} (void)
\begin{DoxyCompactList}\small\item\em clear all vram data with \#0 \end{DoxyCompactList}\item 
void \hyperlink{a00338_a20f89d93d57e0f726ae6393c9a97ac00}{dma\+Copy\+C\+Gram} (u8 $\ast$source, u16 address, u16 size)
\begin{DoxyCompactList}\small\item\em copy data from source to destination using channel 0 of D\+MA available channels in half words \end{DoxyCompactList}\item 
void \hyperlink{a00338_a2f9585bce8262424ff3e8121c6a9e44e}{dma\+Copy\+O\+Aram} (u8 $\ast$source, u16 address, u16 size)
\begin{DoxyCompactList}\small\item\em copies Sprites from source to destination using channel 0 of D\+MA available channels in half words \end{DoxyCompactList}\item 
void \hyperlink{a00338_a4d1d327e4069519217eea680fedb3963}{dma\+Copy\+Spr16\+Vram} (u8 $\ast$source, u16 address)
\begin{DoxyCompactList}\small\item\em copy sprite 16pix size data from source to destination using channel 0 of D\+MA available channels in half words \end{DoxyCompactList}\item 
void \hyperlink{a00338_af6777b440b9ff8d081df38704863c57f}{dma\+Copy\+Spr32\+Vram} (u8 $\ast$source, u16 address)
\begin{DoxyCompactList}\small\item\em copy sprite 32pix size data from source to destination using channel 0 of D\+MA available channels in half words \end{DoxyCompactList}\item 
void \hyperlink{a00338_aaf545b3f811f6ef4b7c4be434701a77a}{dma\+Copy\+Vram} (u8 $\ast$source, u16 address, u16 size)
\begin{DoxyCompactList}\small\item\em copy data from source to destination using channel 0 of D\+MA available channels in half words \end{DoxyCompactList}\item 
void \hyperlink{a00338_aa402636f351eb16696c9e6eb60626a0f}{dma\+Copy\+Vram7} (u8 $\ast$source, u16 address, u16 size, u8 vrammodeinc, u16 dmacontrol)
\begin{DoxyCompactList}\small\item\em copies data from source to destination using channel 0 of D\+MA available channels in half words with V\+M\+A\+IN value \end{DoxyCompactList}\item 
void \hyperlink{a00338_ad0302d82f5e7cefca7ad90d49331cd39}{dma\+Fill\+Vram} (u8 source, u16 address, u16 size)
\begin{DoxyCompactList}\small\item\em fill the source data to destination using channel 0 of D\+MA available channels in half words \end{DoxyCompactList}\item 
void \hyperlink{a00338_ab112388971fc7e139bff7fe394cb49b7}{set\+Mode\+Hdma\+Gradient} (u8 max\+Levels)
\begin{DoxyCompactList}\small\item\em Do a brightness gradient on screen. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Wrapper functions for direct memory access hardware. 



\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{a00338_a384405596b1aadf2454e966455d74228}\label{a00338_a384405596b1aadf2454e966455d74228}} 
\index{dma.\+h@{dma.\+h}!R\+E\+G\+\_\+\+A1\+B7@{R\+E\+G\+\_\+\+A1\+B7}}
\index{R\+E\+G\+\_\+\+A1\+B7@{R\+E\+G\+\_\+\+A1\+B7}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{R\+E\+G\+\_\+\+A1\+B7}{REG\_A1B7}}
{\footnotesize\ttfamily \#define R\+E\+G\+\_\+\+A1\+B7~($\ast$(vuint8$\ast$)0x4374)}



A1\+TxL -\/ H\+D\+MA Table Start Address (low) / D\+MA Current Addr (low) (R/W) A1\+TxH -\/ H\+D\+MA Table Start Address (hi) / D\+MA Current Addr (hi) (R/W) A1\+Bx -\/ H\+D\+MA Table Start Address (bank) / D\+MA Current Addr (bank) (R/W) 

For normal D\+MA\+: 23-\/16 C\+P\+U-\/\+Bus Data Address Bank (constant, not incremented/decremented) 15-\/0 C\+P\+U-\/\+Bus Data Address (incremented/decremented/fixed, as selected)

For H\+D\+MA\+: 23-\/16 C\+P\+U-\/\+Bus Table Address Bank (constant, bank number for 43x8h/43x9h) 15-\/0 C\+P\+U-\/\+Bus Table Address (constant, reload value for 43x8h/43x9h) \mbox{\Hypertarget{a00338_ac9dca819788af60976b8d4956f76ead6}\label{a00338_ac9dca819788af60976b8d4956f76ead6}} 
\index{dma.\+h@{dma.\+h}!R\+E\+G\+\_\+\+D\+A\+S7\+LH@{R\+E\+G\+\_\+\+D\+A\+S7\+LH}}
\index{R\+E\+G\+\_\+\+D\+A\+S7\+LH@{R\+E\+G\+\_\+\+D\+A\+S7\+LH}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{R\+E\+G\+\_\+\+D\+A\+S7\+LH}{REG\_DAS7LH}}
{\footnotesize\ttfamily \#define R\+E\+G\+\_\+\+D\+A\+S7\+LH~($\ast$(vuint16$\ast$)0x4375)}



Indirect H\+D\+MA Address (low) / D\+MA Byte-\/\+Counter (low) (R/W) D\+A\+SxL -\/ Indirect H\+D\+MA Address (low) / D\+MA Byte-\/\+Counter (low) (R/W) D\+A\+SxH -\/ Indirect H\+D\+MA Address (hi) / D\+MA Byte-\/\+Counter (hi) (R/W) 43x7h -\/ D\+A\+S\+Bx -\/ Indirect H\+D\+MA Address (bank) (R/W) 

For normal D\+MA\+: 23-\/16 Not used 15-\/0 Number of bytes to be transferred (1..F\+F\+F\+Fh=1..F\+F\+F\+Fh, or 0=10000h) (This is really a byte-\/counter; with a 4-\/byte \char`\"{}\+Transfer Unit\char`\"{}, len=5 would transfer one whole Unit, plus the first byte of the second Unit.) (The 16bit value is decremented during transfer, and contains 0000h on end.) \mbox{\Hypertarget{a00338_abccd357db38cf6e7528e807b8692ef0f}\label{a00338_abccd357db38cf6e7528e807b8692ef0f}} 
\index{dma.\+h@{dma.\+h}!R\+E\+G\+\_\+\+M\+D\+M\+A\+EN@{R\+E\+G\+\_\+\+M\+D\+M\+A\+EN}}
\index{R\+E\+G\+\_\+\+M\+D\+M\+A\+EN@{R\+E\+G\+\_\+\+M\+D\+M\+A\+EN}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{R\+E\+G\+\_\+\+M\+D\+M\+A\+EN}{REG\_MDMAEN}}
{\footnotesize\ttfamily \#define R\+E\+G\+\_\+\+M\+D\+M\+A\+EN~($\ast$(vuint8$\ast$)0x420\+B)}



Select General Purpose D\+MA Channel(s) and Start Transfer (W) 7-\/0 General Purpose D\+MA Channel 7-\/0 Enable (0=Disable, 1=Enable) 

When writing a non-\/zero value to this register, general purpose D\+MA will be started immediately (after a few clk cycles). The C\+PU is paused during the transfer. The transfer can be interrupted by H-\/\+D\+MA transfers. If more than 1 bit is set in M\+D\+M\+A\+EN, then the separate transfers will be executed in W\+H\+I\+CH? priority order. The M\+D\+M\+A\+EN bits are cleared automatically at transfer completion. Do not use channels for G\+P-\/\+D\+MA which are activated as H-\/\+D\+MA in H\+D\+M\+A\+EN. 

\subsection{Function Documentation}
\mbox{\Hypertarget{a00338_a20f89d93d57e0f726ae6393c9a97ac00}\label{a00338_a20f89d93d57e0f726ae6393c9a97ac00}} 
\index{dma.\+h@{dma.\+h}!dma\+Copy\+C\+Gram@{dma\+Copy\+C\+Gram}}
\index{dma\+Copy\+C\+Gram@{dma\+Copy\+C\+Gram}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{dma\+Copy\+C\+Gram()}{dmaCopyCGram()}}
{\footnotesize\ttfamily void dma\+Copy\+C\+Gram (\begin{DoxyParamCaption}\item[{u8 $\ast$}]{source,  }\item[{u16}]{address,  }\item[{u16}]{size }\end{DoxyParamCaption})}



copy data from source to destination using channel 0 of D\+MA available channels in half words 

copies Palette from source to destination using channel 0 of D\+MA available channels in half words


\begin{DoxyParams}{Parameters}
{\em source} & the source to copy from \\
\hline
{\em address} & cgram address to copy \\
\hline
{\em size} & the size in bytes of the data to copy.\\
\hline
{\em source} & the source to copy from \\
\hline
{\em address} & vram address to copy \\
\hline
{\em size} & the size in bytes of the data to copy. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{a00338_a2f9585bce8262424ff3e8121c6a9e44e}\label{a00338_a2f9585bce8262424ff3e8121c6a9e44e}} 
\index{dma.\+h@{dma.\+h}!dma\+Copy\+O\+Aram@{dma\+Copy\+O\+Aram}}
\index{dma\+Copy\+O\+Aram@{dma\+Copy\+O\+Aram}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{dma\+Copy\+O\+Aram()}{dmaCopyOAram()}}
{\footnotesize\ttfamily void dma\+Copy\+O\+Aram (\begin{DoxyParamCaption}\item[{u8 $\ast$}]{source,  }\item[{u16}]{address,  }\item[{u16}]{size }\end{DoxyParamCaption})}



copies Sprites from source to destination using channel 0 of D\+MA available channels in half words 


\begin{DoxyParams}{Parameters}
{\em source} & the source to copy from \\
\hline
{\em address} & vram address to copy \\
\hline
{\em size} & the size in bytes of the data to copy. \\
\hline
\end{DoxyParams}
\begin{Desc}
\item[Examples\+: ]\par
\hyperlink{a00429}{graphics/\+Sprites/\+Dynamic\+Sprite/\+Dynamic\+Sprite.\+c}.\end{Desc}
\mbox{\Hypertarget{a00338_a4d1d327e4069519217eea680fedb3963}\label{a00338_a4d1d327e4069519217eea680fedb3963}} 
\index{dma.\+h@{dma.\+h}!dma\+Copy\+Spr16\+Vram@{dma\+Copy\+Spr16\+Vram}}
\index{dma\+Copy\+Spr16\+Vram@{dma\+Copy\+Spr16\+Vram}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{dma\+Copy\+Spr16\+Vram()}{dmaCopySpr16Vram()}}
{\footnotesize\ttfamily void dma\+Copy\+Spr16\+Vram (\begin{DoxyParamCaption}\item[{u8 $\ast$}]{source,  }\item[{u16}]{address }\end{DoxyParamCaption})}



copy sprite 16pix size data from source to destination using channel 0 of D\+MA available channels in half words 


\begin{DoxyParams}{Parameters}
{\em source} & the source to copy from \\
\hline
{\em address} & vram address to copy \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{a00338_af6777b440b9ff8d081df38704863c57f}\label{a00338_af6777b440b9ff8d081df38704863c57f}} 
\index{dma.\+h@{dma.\+h}!dma\+Copy\+Spr32\+Vram@{dma\+Copy\+Spr32\+Vram}}
\index{dma\+Copy\+Spr32\+Vram@{dma\+Copy\+Spr32\+Vram}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{dma\+Copy\+Spr32\+Vram()}{dmaCopySpr32Vram()}}
{\footnotesize\ttfamily void dma\+Copy\+Spr32\+Vram (\begin{DoxyParamCaption}\item[{u8 $\ast$}]{source,  }\item[{u16}]{address }\end{DoxyParamCaption})}



copy sprite 32pix size data from source to destination using channel 0 of D\+MA available channels in half words 


\begin{DoxyParams}{Parameters}
{\em source} & the source to copy from \\
\hline
{\em address} & vram address to copy \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{a00338_aaf545b3f811f6ef4b7c4be434701a77a}\label{a00338_aaf545b3f811f6ef4b7c4be434701a77a}} 
\index{dma.\+h@{dma.\+h}!dma\+Copy\+Vram@{dma\+Copy\+Vram}}
\index{dma\+Copy\+Vram@{dma\+Copy\+Vram}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{dma\+Copy\+Vram()}{dmaCopyVram()}}
{\footnotesize\ttfamily void dma\+Copy\+Vram (\begin{DoxyParamCaption}\item[{u8 $\ast$}]{source,  }\item[{u16}]{address,  }\item[{u16}]{size }\end{DoxyParamCaption})}



copy data from source to destination using channel 0 of D\+MA available channels in half words 


\begin{DoxyParams}{Parameters}
{\em source} & the source to copy from \\
\hline
{\em address} & vram address to copy \\
\hline
{\em size} & the size in bytes of the data to copy. \\
\hline
\end{DoxyParams}
\begin{Desc}
\item[Examples\+: ]\par
\hyperlink{a00435}{games/likemario/\+Like\+Mario.\+c}, \hyperlink{a00415}{graphics/\+Backgrounds/\+Mode3/\+Mode3.\+c}, \hyperlink{a00419}{graphics/\+Effects/\+H\+D\+M\+A\+Gradient/\+H\+D\+M\+A\+Gradient.\+c}, and \hyperlink{a00429}{graphics/\+Sprites/\+Dynamic\+Sprite/\+Dynamic\+Sprite.\+c}.\end{Desc}
\mbox{\Hypertarget{a00338_aa402636f351eb16696c9e6eb60626a0f}\label{a00338_aa402636f351eb16696c9e6eb60626a0f}} 
\index{dma.\+h@{dma.\+h}!dma\+Copy\+Vram7@{dma\+Copy\+Vram7}}
\index{dma\+Copy\+Vram7@{dma\+Copy\+Vram7}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{dma\+Copy\+Vram7()}{dmaCopyVram7()}}
{\footnotesize\ttfamily void dma\+Copy\+Vram7 (\begin{DoxyParamCaption}\item[{u8 $\ast$}]{source,  }\item[{u16}]{address,  }\item[{u16}]{size,  }\item[{u8}]{vrammodeinc,  }\item[{u16}]{dmacontrol }\end{DoxyParamCaption})}



copies data from source to destination using channel 0 of D\+MA available channels in half words with V\+M\+A\+IN value 


\begin{DoxyParams}{Parameters}
{\em source} & the source to copy from \\
\hline
{\em address} & vram address to copy \\
\hline
{\em size} & the size in bytes of the data to copy. \\
\hline
{\em vrammodeinc} & the value of R\+E\+G\+\_\+\+V\+M\+A\+IN (incr or not incr). \\
\hline
{\em dmacontrol} & the value of D\+MA control register (incr or not incr, \$18 or \$19, and so on). \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{a00338_ad0302d82f5e7cefca7ad90d49331cd39}\label{a00338_ad0302d82f5e7cefca7ad90d49331cd39}} 
\index{dma.\+h@{dma.\+h}!dma\+Fill\+Vram@{dma\+Fill\+Vram}}
\index{dma\+Fill\+Vram@{dma\+Fill\+Vram}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{dma\+Fill\+Vram()}{dmaFillVram()}}
{\footnotesize\ttfamily void dma\+Fill\+Vram (\begin{DoxyParamCaption}\item[{u8}]{source,  }\item[{u16}]{address,  }\item[{u16}]{size }\end{DoxyParamCaption})}



fill the source data to destination using channel 0 of D\+MA available channels in half words 


\begin{DoxyParams}{Parameters}
{\em source} & the value of source to copy from \\
\hline
{\em address} & vram address to copy \\
\hline
{\em size} & the size in bytes of the data to copy. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{a00338_ab112388971fc7e139bff7fe394cb49b7}\label{a00338_ab112388971fc7e139bff7fe394cb49b7}} 
\index{dma.\+h@{dma.\+h}!set\+Mode\+Hdma\+Gradient@{set\+Mode\+Hdma\+Gradient}}
\index{set\+Mode\+Hdma\+Gradient@{set\+Mode\+Hdma\+Gradient}!dma.\+h@{dma.\+h}}
\subsubsection{\texorpdfstring{set\+Mode\+Hdma\+Gradient()}{setModeHdmaGradient()}}
{\footnotesize\ttfamily void set\+Mode\+Hdma\+Gradient (\begin{DoxyParamCaption}\item[{u8}]{max\+Levels }\end{DoxyParamCaption})}



Do a brightness gradient on screen. 


\begin{DoxyParams}{Parameters}
{\em max\+Levels} & value between 1..15 for the maximum level of brightness (15=light, 1=near dark) \\
\hline
\end{DoxyParams}
\begin{Desc}
\item[Examples\+: ]\par
\hyperlink{a00419}{graphics/\+Effects/\+H\+D\+M\+A\+Gradient/\+H\+D\+M\+A\+Gradient.\+c}.\end{Desc}
